# üìπ Video Analytics Bot

–ë–æ—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤–∏–¥–µ–æ-–∫—Ä–µ–∞—Ç–æ—Ä–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **–Ω–∞—Ç—É—Ä–∞–ª—å–Ω–æ–≥–æ —è–∑—ã–∫–∞**.



## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

* üìä –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤–∏–¥–µ–æ –ø–æ –∑–∞–ø—Ä–æ—Å–∞–º –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
* ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SQL –∑–∞–ø—Ä–æ—Å–æ–≤ —á–µ—Ä–µ–∑ LLM (OpenAI –∏–ª–∏ Claude)
* üíæ –†–∞–±–æ—Ç–∞ —Å PostgreSQL –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
* ‚ö° –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
* üîí –ó–∞—â–∏—Ç–∞ –æ—Ç –æ–ø–∞—Å–Ω—ã—Ö SQL –æ–ø–µ—Ä–∞—Ü–∏–π


## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º **senior-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**:

* **–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** ‚Äî database, llm, query, bot
* **–ê–±—Å—Ç—Ä–∞–∫—Ü–∏–∏** ‚Äî –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è LLM –∫–ª–∏–µ–Ω—Ç–æ–≤
* **Dependency Injection** ‚Äî –≥–∏–±–∫–∞—è —Å–º–µ–Ω–∞ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
* **Async/Await** ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞
* **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
* **–í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ SQL –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
* **–ë–∞—Ç—á–∏–Ω–≥** ‚Äî —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö


## ‚öôÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

* Python 3.10+
* PostgreSQL 13+
* Telegram Bot Token
* API –∫–ª—é—á OpenAI –∏–ª–∏ Anthropic


## üõ† –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1Ô∏è‚É£ –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone <your-repo>
cd video-analytics-bot
```

### 2Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv\Scripts\activate     # Windows
```

### 3Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

### 4Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö PostgreSQL

```sql
CREATE DATABASE video_analytics;
```

### 5Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

```env
TELEGRAM_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–±–æ—Ç–∞
DB_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å_postgres
OPENAI_API_KEY=–≤–∞—à_–∫–ª—é—á_openai
LLM_PROVIDER=openai
```

### 6Ô∏è‚É£ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```bash
python scripts/init_db.py
```

### 7Ô∏è‚É£ –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ

–ü–æ–º–µ—Å—Ç–∏—Ç–µ `videos.json` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `data/` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
python scripts/load_data.py data/videos.json
```

### 8Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
python main.py
```

## üí¨ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

* "–°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –≤–∏–¥–µ–æ –µ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ?"
* "–°–∫–æ–ª—å–∫–æ –≤–∏–¥–µ–æ —É –∫—Ä–µ–∞—Ç–æ—Ä–∞ —Å id 123 –≤—ã—à–ª–æ —Å 1 –Ω–æ—è–±—Ä—è –ø–æ 5 –Ω–æ—è–±—Ä—è 2025 –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ?"
* "–°–∫–æ–ª—å–∫–æ –≤–∏–¥–µ–æ –Ω–∞–±—Ä–∞–ª–æ –±–æ–ª—å—à–µ 100 000 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∑–∞ –≤—Å—ë –≤—Ä–µ–º—è?"
* "–ù–∞ —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –≤ —Å—É–º–º–µ –≤—ã—Ä–æ—Å–ª–∏ –≤—Å–µ –≤–∏–¥–µ–æ 28 –Ω–æ—è–±—Ä—è 2025?"
* "–°–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω—ã—Ö –≤–∏–¥–µ–æ –ø–æ–ª—É—á–∞–ª–∏ –Ω–æ–≤—ã–µ –ø—Ä–æ—Å–º–æ—Ç—Ä—ã 27 –Ω–æ—è–±—Ä—è 2025?"


## üß† LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

### OpenAI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```env
LLM_PROVIDER=openai
OPENAI_API_KEY=sk-...
```

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å `gpt-4o-mini` ‚Äî –±—ã—Å—Ç—Ä–∞—è –∏ —ç–∫–æ–Ω–æ–º–∏—á–Ω–∞—è.

### Anthropic Claude

```env
LLM_PROVIDER=anthropic
ANTHROPIC_API_KEY=sk-ant-...
```

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `claude-3-5-haiku` ‚Äî –±—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å Claude.


## üóÑ –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `videos`

* `id` ‚Äî UUID –≤–∏–¥–µ–æ
* `creator_id` ‚Äî UUID –∫—Ä–µ–∞—Ç–æ—Ä–∞
* `video_created_at` ‚Äî –¥–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
* `views_count`, `likes_count`, `comments_count`, `reports_count` ‚Äî –∏—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –¢–∞–±–ª–∏—Ü–∞ `video_snapshots`

* `id` ‚Äî UUID —Å–Ω–∞–ø—à–æ—Ç–∞
* `video_id` ‚Äî —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∏–¥–µ–æ
* `views_count`, `likes_count` –∏ —Ç.–¥. ‚Äî –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–º–µ—Ä–∞
* `delta_views_count`, `delta_likes_count` –∏ —Ç.–¥. ‚Äî –ø—Ä–∏—Ä–æ—Å—Ç—ã
* `created_at` ‚Äî –≤—Ä–µ–º—è –∑–∞–º–µ—Ä–∞

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–æ–ø—Ä–æ—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
2. **QueryParser** –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç SQL —á–µ—Ä–µ–∑ LLM
3. **QueryExecutor** –±–µ–∑–æ–ø–∞—Å–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å
4. –ë–æ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–æ–¥–Ω–æ —á–∏—Å–ª–æ)

## üõ° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–∞—Å–Ω—ã—Ö SQL –æ–ø–µ—Ä–∞—Ü–∏–π (DROP, DELETE, UPDATE)
* ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ SQLAlchemy
* ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
* ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫


